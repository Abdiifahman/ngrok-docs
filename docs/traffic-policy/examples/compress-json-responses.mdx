---
title: Compress JSON Responses Example
sidebar_label: Compress JSON Responses
---

import TabItem from "@theme/TabItem";
import Tabs from "@theme/Tabs";
import ConfigExample from "/src/components/ConfigExample.tsx";

With Traffic Policy, you can ensure all JSON responses returned by your upstream services are [compressed](/docs/http/traffic-policy/actions/compress-response.mdx) en route to the API consumer.

This rule compresses JSON responses using the `gzip`, `br`, `deflate`, and `compress` algorithms.

:::note
If your upstream service already handles compression, ngrok skips this step.
:::

<Tabs groupId="exampleType" queryString="type" defaultValue="snippet">

<TabItem value="snippet" label="Snippet">

<ConfigExample
	config={{
		on_http_response: [
			{
				name: "Add compression",
				actions: [
					{
						type: "compress-response",
						config: {
							algorithms: ["gzip", "br", "deflate", "compress"],
						},
					},
				],
			},
		],
	}}
/>

</TabItem>

<TabItem value="full" label="Full Configuration File">

```yaml mode=traffic-policy title="config.yml"
endpoints:
	- name: my-agent-endpoint
	- description: My first Agent Endpoint with a Traffic Policy
	- upstream:
		- url: 80
	- traffic_policy:
		on_http_response:
		- name: Add compression
				actions:
				- type: compress-response
						config:
						algorithms:
								- gzip
								- br
								- deflate
								- compress
```

</TabItem>

</Tabs>

See [the `compress-response` Traffic Policy action docs](/traffic-policy/actions/compress-response/) for more information.
