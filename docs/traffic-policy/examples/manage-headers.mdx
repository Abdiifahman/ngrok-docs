---
title: Manage Headers Examples
sidebar_label: Manage Headers
---

import ConfigExample from "/src/components/ConfigExample.tsx";


With Traffic Policy, you can add or remove headers from requests to provide more context to your upstream service or withhold sensitive information. This page demonstrates a few examples of doing so.

## Enrich your upstream service

Add new headers to requests to give your upstream service more context about the consumer, which in turn allows for richer functionality, such as localized languages and pricing.

<ConfigExample
    config={{
        on_http_request: [
            {
                actions: [
                    {
                        type: "add-headers",
                        config: {
                            "x-is-ngrok": "1",
                            "x-endpoint-id": "${endpoint.id}",
                            "x-client-ip": "${conn.client_ip}",
                            "x-client-conn-start": "${conn.ts.start}",
                            "x-client-loc": "${conn.geo.city}, ${conn.geo.country}",
                            "x-client-path": "${req.url.path}",
                        },
                    },
                ],
            },
        ],
    }}
/>

## Remove service details from response headers

Some frameworks, like [Express](https://expressjs.com/), add headers like
`X-Powered-By: Express` to responses, which you may not want to reveal to your
users.

The following example removes the `X-Powered-By` header.

<ConfigExample
    config={{
        on_http_request: [
            {
                actions: [
                    {
                        type: "remove-headers",
                        config: {
                            headers: [
                                "X-Powered-By",
                            ],
                        }
                    },
                ],
            },
        ],
    }}
/>


### Deprecate an API version

By include a `X-Api-Version` header in your API reference or developer documentation, you can quickly return a helpful error message, which encourages them to explore usage of the new version.

<ConfigExample
    config={{
        on_http_request: [
            {
                expressions: ["'2' in req.headers['X-Api-Version']"],
                name: "Deprecate API v2",
                actions: [
                    {
                        type: "custom-response",
                        config: {
                            status_code: 400,
                            content:
                                '{"error":{"message":"Version 2 of the API is no longer supported. Use Version 3 instead."}}',
                        },
                    },
                ],
            },
        ],
        on_http_response: [],
    }}
/>