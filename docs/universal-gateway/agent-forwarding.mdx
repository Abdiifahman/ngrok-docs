---
title: How does Agent Forwarding Work?
---

import TabItem from "@theme/TabItem";
import Tabs from "@theme/Tabs";

import { LangSwitcher } from "@site/src/components/LangSwitcher";
import TlsLimits from "../_tls_limits.mdx";

import RandomAgentCliExample from "/examples/agent-cli/http-random.mdx";
import RandomAgentConfigExample from "/examples/agent-config/http-random.mdx";
import RandomGoSdkExample from "/examples/go-sdk/http-random.mdx";
import RandomJavascriptSdkExample from "/examples/javascript-sdk/http-random.mdx";
import RandomPythonSdkExample from "/examples/python-sdk/http-random.mdx";
import RandomRustSdkExample from "/examples/rust-sdk/http-random.mdx";
import RandomSshExample from "/examples/ssh/http-random.mdx";

import StaticDomainAgentCliExample from "/examples/agent-cli/http-static-domain.mdx";
import StaticDomainAgentConfigExample from "/examples/agent-config/http-static-domain.mdx";
import StaticDomainGoSdkExample from "/examples/go-sdk/http-static-domain.mdx";
import StaticDomainJavascriptSdkExample from "/examples/javascript-sdk/http-static-domain.mdx";
import StaticDomainKubernetesExample from "/examples/k8s/http-static-domain.mdx";
import StaticDomainPythonSdkExample from "/examples/python-sdk/http-static-domain.mdx";
import StaticDomainRustSdkExample from "/examples/rust-sdk/http-static-domain.mdx";
import StaticDomainSshExample from "/examples/ssh/http-static-domain.mdx";

import BrandedDomainAgentCliExample from "/examples/agent-cli/http-branded-domain.mdx";
import BrandedDomainAgentConfigExample from "/examples/agent-config/http-branded-domain.mdx";
import BrandedDomainGoSdkExample from "/examples/go-sdk/http-branded-domain.mdx";
import BrandedDomainJavascriptSdkExample from "/examples/javascript-sdk/http-branded-domain.mdx";
import BrandedDomainKubernetesExample from "/examples/k8s/http-branded-domain.mdx";
import BrandedDomainPythonSdkExample from "/examples/python-sdk/http-branded-domain.mdx";
import BrandedDomainRustSdkExample from "/examples/rust-sdk/http-branded-domain.mdx";
import BrandedDomainSshExample from "/examples/ssh/http-branded-domain.mdx";

import BasicAuthAgentCliExample from "/examples/agent-cli/http-basic-auth.mdx";
import BasicAuthAgentConfigExample from "/examples/agent-config/http-basic-auth.mdx";
import BasicAuthGoSdkExample from "/examples/go-sdk/http-basic-auth.mdx";
import BasicAuthJavascriptSdkExample from "/examples/javascript-sdk/http-basic-auth.mdx";
import BasicAuthKubernetesExample from "/examples/k8s/http-basic-auth.mdx";
import BasicAuthPythonSdkExample from "/examples/python-sdk/http-basic-auth.mdx";
import BasicAuthRustSdkExample from "/examples/rust-sdk/http-basic-auth.mdx";
import BasicAuthSshExample from "/examples/ssh/http-basic-auth.mdx";

import OAuthAgentCliExample from "/examples/agent-cli/http-oauth-authn.mdx";
import OAuthAgentConfigExample from "/examples/agent-config/http-oauth-authn.mdx";
import OAuthGoSdkExample from "/examples/go-sdk/http-oauth-authn.mdx";
import OAuthJavascriptSdkExample from "/examples/javascript-sdk/http-oauth-authn.mdx";
import OAuthKubernetesExample from "/examples/k8s/http-oauth-authn.mdx";
import OAuthPythonSdkExample from "/examples/python-sdk/http-oauth-authn.mdx";
import OAuthRustSdkExample from "/examples/rust-sdk/http-oauth-authn.mdx";
import OAuthSshExample from "/examples/ssh/http-oauth-authn.mdx";

import ForwardHttpsAgentCliExample from "/examples/agent-cli/http-forward-https.mdx";
import ForwardHttpsAgentConfigExample from "/examples/agent-config/http-forward-https.mdx";
import ForwardHttpsGoSdkExample from "/examples/go-sdk/http-forward-https.mdx";
import ForwardHttpsJavascriptSdkExample from "/examples/javascript-sdk/http-forward-https.mdx";
import ForwardHttpsKubernetesExample from "/examples/k8s/http-forward-https.mdx";
import ForwardHttpsPythonSdkExample from "/examples/python-sdk/http-forward-https.mdx";
import ForwardHttpsRustSdkExample from "/examples/rust-sdk/http-forward-https.mdx";
import ForwardHttpsSshExample from "/examples/ssh/http-forward-https.mdx";

import HostHeaderAgentCliExample from "/examples/agent-cli/http-rewrite-host-header.mdx";
import HostHeaderAgentConfigExample from "/examples/agent-config/http-rewrite-host-header.mdx";
import HostHeaderGoSdkExample from "/examples/go-sdk/http-rewrite-host-header.mdx";
import HostHeaderJavascriptSdkExample from "/examples/javascript-sdk/http-rewrite-host-header.mdx";
import HostHeaderKubernetesExample from "/examples/k8s/http-rewrite-host-header.mdx";
import HostHeaderPythonSdkExample from "/examples/python-sdk/http-rewrite-host-header.mdx";
import HostHeaderRustSdkExample from "/examples/rust-sdk/http-rewrite-host-header.mdx";
import HostHeaderSshExample from "/examples/ssh/http-rewrite-host-header.mdx";

import NonLocalAgentCliExample from "/examples/agent-cli/http-nonlocal.mdx";
import NonLocalAgentConfigExample from "/examples/agent-config/http-nonlocal.mdx";
import NonLocalGoSdkExample from "/examples/go-sdk/http-nonlocal.mdx";
import NonLocalJavascriptSdkExample from "/examples/javascript-sdk/http-nonlocal.mdx";
import NonLocalKubernetesExample from "/examples/k8s/http-nonlocal.mdx";
import NonLocalPythonSdkExample from "/examples/python-sdk/http-nonlocal.mdx";
import NonLocalRustSdkExample from "/examples/rust-sdk/http-nonlocal.mdx";
import NonLocalSshExample from "/examples/ssh/http-nonlocal.mdx";

import AbsPathFileserverAgentCliExample from "/examples/agent-cli/http-fileserver-abs-path.mdx";
import AbsPathFileserverAgentConfigExample from "/examples/agent-config/http-fileserver-abs-path.mdx";
import AbsPathFileserverGoSdkExample from "/examples/go-sdk/http-fileserver-abs-path.mdx";
import AbsPathFileserverJavascriptSdkExample from "/examples/javascript-sdk/http-fileserver-abs-path.mdx";
import AbsPathFileserverKubernetesExample from "/examples/k8s/http-fileserver-abs-path.mdx";
import AbsPathFileserverPythonSdkExample from "/examples/python-sdk/http-fileserver-abs-path.mdx";
import AbsPathFileserverRustSdkExample from "/examples/rust-sdk/http-fileserver-abs-path.mdx";
import AbsPathFileserverSshExample from "/examples/ssh/http-fileserver-abs-path.mdx";

import WorkingDirFileserverAgentCliExample from "/examples/agent-cli/http-fileserver-working-dir.mdx";
import WorkingDirFileserverAgentConfigExample from "/examples/agent-config/http-fileserver-working-dir.mdx";
import WorkingDirFileserverGoSdkExample from "/examples/go-sdk/http-fileserver-working-dir.mdx";
import WorkingDirFileserverJavascriptSdkExample from "/examples/javascript-sdk/http-fileserver-working-dir.mdx";
import WorkingDirFileserverKubernetesExample from "/examples/k8s/http-fileserver-working-dir.mdx";
import WorkingDirFileserverPythonSdkExample from "/examples/python-sdk/http-fileserver-working-dir.mdx";
import WorkingDirFileserverRustSdkExample from "/examples/rust-sdk/http-fileserver-working-dir.mdx";
import WorkingDirFileserverSshExample from "/examples/ssh/http-fileserver-working-dir.mdx";

import WindowsFileserverAgentCliExample from "/examples/agent-cli/http-fileserver-windows.mdx";
import WindowsFileserverAgentConfigExample from "/examples/agent-config/http-fileserver-windows.mdx";
import WindowsFileserverGoSdkExample from "/examples/go-sdk/http-fileserver-windows.mdx";
import WindowsFileserverJavascriptSdkExample from "/examples/javascript-sdk/http-fileserver-windows.mdx";
import WindowsFileserverKubernetesExample from "/examples/k8s/http-fileserver-windows.mdx";
import WindowsFileserverPythonSdkExample from "/examples/python-sdk/http-fileserver-windows.mdx";
import WindowsFileserverRustSdkExample from "/examples/rust-sdk/http-fileserver-windows.mdx";
import WindowsFileserverSshExample from "/examples/ssh/http-fileserver-windows.mdx";

import RandomAgentCliExample from "/examples/agent-cli/tcp-random.mdx";
import RandomAgentConfigExample from "/examples/agent-config/tcp-random.mdx";
import RandomGoSdkExample from "/examples/go-sdk/tcp-random.mdx";
import RandomJavascriptSdkExample from "/examples/javascript-sdk/tcp-random.mdx";
import RandomKubernetesExample from "/examples/k8s/tcp-random.mdx";
import RandomPythonSdkExample from "/examples/python-sdk/tcp-random.mdx";
import RandomRustSdkExample from "/examples/rust-sdk/tcp-random.mdx";
import RandomSshExample from "/examples/ssh/tcp-random.mdx";

import FixedAgentCliExample from "/examples/agent-cli/tcp-fixed.mdx";
import FixedAgentConfigExample from "/examples/agent-config/tcp-fixed.mdx";
import FixedGoSdkExample from "/examples/go-sdk/tcp-fixed.mdx";
import FixedJavascriptSdkExample from "/examples/javascript-sdk/tcp-fixed.mdx";
import FixedKubernetesExample from "/examples/k8s/tcp-fixed.mdx";
import FixedPythonSdkExample from "/examples/python-sdk/tcp-fixed.mdx";
import FixedRustSdkExample from "/examples/rust-sdk/tcp-fixed.mdx";
import FixedSshExample from "/examples/ssh/tcp-fixed.mdx";

import NonLocalAgentCliExample from "/examples/agent-cli/tcp-nonlocal.mdx";
import NonLocalAgentConfigExample from "/examples/agent-config/tcp-nonlocal.mdx";
import NonLocalGoSdkExample from "/examples/go-sdk/tcp-nonlocal.mdx";
import NonLocalJavascriptSdkExample from "/examples/javascript-sdk/tcp-nonlocal.mdx";
import NonLocalKubernetesExample from "/examples/k8s/tcp-nonlocal.mdx";
import NonLocalPythonSdkExample from "/examples/python-sdk/tcp-nonlocal.mdx";
import NonLocalRustSdkExample from "/examples/rust-sdk/tcp-nonlocal.mdx";
import NonLocalSshExample from "/examples/ssh/tcp-nonlocal.mdx";

import ProxyProtoAgentCliExample from "/examples/agent-cli/tcp-proxyproto.mdx";
import ProxyProtoAgentConfigExample from "/examples/agent-config/tcp-proxyproto.mdx";
import ProxyProtoGoSdkExample from "/examples/go-sdk/tcp-proxyproto.mdx";
import ProxyProtoJavascriptSdkExample from "/examples/javascript-sdk/tcp-proxyproto.mdx";
import ProxyProtoKubernetesExample from "/examples/k8s/tcp-proxyproto.mdx";
import ProxyProtoPythonSdkExample from "/examples/python-sdk/tcp-proxyproto.mdx";
import ProxyProtoRustSdkExample from "/examples/rust-sdk/tcp-proxyproto.mdx";
import ProxyProtoSshExample from "/examples/ssh/tcp-proxyproto.mdx";

import AtAgentAgentCliExample from "/examples/agent-cli/tls-terminate-at-agent.mdx";
import AtAgentAgentConfigExample from "/examples/agent-config/tls-terminate-at-agent.mdx";
import AtAgentGoSdkExample from "/examples/go-sdk/tls-terminate-at-agent.mdx";
import AtAgentJavascriptSdkExample from "/examples/javascript-sdk/tls-terminate-at-agent.mdx";
import AtAgentKubernetesExample from "/examples/k8s/tls-terminate-at-agent.mdx";
import AtAgentPythonSdkExample from "/examples/python-sdk/tls-terminate-at-agent.mdx";
import AtAgentRustSdkExample from "/examples/rust-sdk/tls-terminate-at-agent.mdx";
import AtAgentSshExample from "/examples/ssh/tls-terminate-at-agent.mdx";

import AtUpstreamAgentCliExample from "/examples/agent-cli/tls-terminate-at-upstream.mdx";
import AtUpstreamAgentConfigExample from "/examples/agent-config/tls-terminate-at-upstream.mdx";
import AtUpstreamGoSdkExample from "/examples/go-sdk/tls-terminate-at-upstream.mdx";
import AtUpstreamJavascriptSdkExample from "/examples/javascript-sdk/tls-terminate-at-upstream.mdx";
import AtUpstreamKubernetesExample from "/examples/k8s/tls-terminate-at-upstream.mdx";
import AtUpstreamPythonSdkExample from "/examples/python-sdk/tls-terminate-at-upstream.mdx";
import AtUpstreamRustSdkExample from "/examples/rust-sdk/tls-terminate-at-upstream.mdx";
import AtUpstreamSshExample from "/examples/ssh/tls-terminate-at-upstream.mdx";

import CustomDomainAgentCliExample from "/examples/agent-cli/tls-terminate-at-edge-custom-domain.mdx";
import CustomDomainAgentConfigExample from "/examples/agent-config/tls-terminate-at-edge-custom-domain.mdx";
import CustomDomainGoSdkExample from "/examples/go-sdk/tls-terminate-at-edge-custom-domain.mdx";
import CustomDomainJavascriptSdkExample from "/examples/javascript-sdk/tls-terminate-at-edge-custom-domain.mdx";
import CustomDomainKubernetesExample from "/examples/k8s/tls-terminate-at-edge-custom-domain.mdx";
import CustomDomainPythonSdkExample from "/examples/python-sdk/tls-terminate-at-edge-custom-domain.mdx";
import CustomDomainRustSdkExample from "/examples/rust-sdk/tls-terminate-at-edge-custom-domain.mdx";
import CustomDomainSshExample from "/examples/ssh/tls-terminate-at-edge-custom-domain.mdx";

import ReencryptUpstreamAgentCliExample from "/examples/agent-cli/tls-reencrypt-upstream.mdx";
import ReencryptUpstreamAgentConfigExample from "/examples/agent-config/tls-reencrypt-upstream.mdx";
import ReencryptUpstreamGoSdkExample from "/examples/go-sdk/tls-reencrypt-upstream.mdx";
import ReencryptUpstreamJavascriptSdkExample from "/examples/javascript-sdk/tls-reencrypt-upstream.mdx";
import ReencryptUpstreamKubernetesExample from "/examples/k8s/tls-reencrypt-upstream.mdx";
import ReencryptUpstreamPythonSdkExample from "/examples/python-sdk/tls-reencrypt-upstream.mdx";
import ReencryptUpstreamRustSdkExample from "/examples/rust-sdk/tls-reencrypt-upstream.mdx";
import ReencryptUpstreamSshExample from "/examples/ssh/tls-reencrypt-upstream.mdx";

import ProxyProtoAgentCliExample from "/examples/agent-cli/tls-proxyproto.mdx";
import ProxyProtoAgentConfigExample from "/examples/agent-config/tls-proxyproto.mdx";
import ProxyProtoGoSdkExample from "/examples/go-sdk/tls-proxyproto.mdx";
import ProxyProtoJavascriptSdkExample from "/examples/javascript-sdk/tls-proxyproto.mdx";
import ProxyProtoKubernetesExample from "/examples/k8s/tls-proxyproto.mdx";
import ProxyProtoPythonSdkExample from "/examples/python-sdk/tls-proxyproto.mdx";
import ProxyProtoRustSdkExample from "/examples/rust-sdk/tls-proxyproto.mdx";
import ProxyProtoSshExample from "/examples/ssh/tls-proxyproto.mdx";

The [ngrok agent](/agent/) and [Agent
SDKs](/agent-sdks/) forward traffic that your endpoints receive
to upstream services. You specify a URL or port number to instruct the ngrok
agent where and how to forward traffic.

### HTTPS forwarding

The scheme in your upstream URL is used to determine whether to forward HTTP or
HTTPS traffic to the upstream service. If you do not specify a scheme, the
default `http` scheme is chosen _unless_ you forward to port `443`, in which
case ngrok will use `https`. Consult the following table of examples.

| Upstream URL             | Normalized Value         |
| ------------------------ | ------------------------ |
| `http://localhost:1234`  | `http://localhost:1234`  |
| `https://localhost:1234` | `https://localhost:1234` |
| `localhost:1234`         | `http://localhost:1234`  |
| `1234`                   | `http://localhost:1234`  |
| `localhost:443`          | `https://localhost:443`  |
| `443`                    | `https://localhost:443`  |

ngrok assumes that the network you run the agent on is private and it does not
verify the TLS certificate presented by the upstream service. You may change
this behavior with the [flags `--upstream-tls-verify` and
`upstream-tls-verify-cas`](/agent/cli/#ngrok-http).

<Tabs groupId="connectivity" queryString="cty">
	<TabItem value="agent-cli" label="Agent CLI" default>
		<ForwardHttpsAgentCliExample />
	</TabItem>
	<TabItem value="agent-config" label="Agent Config">
		<ForwardHttpsAgentConfigExample />
	</TabItem>
	<TabItem value="ssh" label="SSH">
		<ForwardHttpsSshExample />
	</TabItem>
	<TabItem value="go-sdk" label="Go">
		<ForwardHttpsGoSdkExample />
	</TabItem>
	<TabItem value="javascript-sdk" label="Javascript">
		<ForwardHttpsJavascriptSdkExample />
	</TabItem>
	<TabItem value="python-sdk" label="Python">
		<ForwardHttpsPythonSdkExample />
	</TabItem>
	<TabItem value="rust-sdk" label="Rust">
		<ForwardHttpsRustSdkExample />
	</TabItem>
	<TabItem value="k8s" label="Kubernetes Controller">
		<ForwardHttpsKubernetesExample />
	</TabItem>
</Tabs>

### Non-local forwarding

Agents don't just forward to ports on your localhost. You can forward traffic
to any address or URL reachable from the agent. For example, if you want to
forward traffic to a HTTP server running on your network at `192.168.1.2:80`:

<Tabs groupId="connectivity" queryString="cty">
	<TabItem value="agent-cli" label="Agent CLI" default>
		<NonLocalAgentCliExample />
	</TabItem>
	<TabItem value="agent-config" label="Agent Config">
		<NonLocalAgentConfigExample />
	</TabItem>
	<TabItem value="ssh" label="SSH">
		<NonLocalSshExample />
	</TabItem>
	<TabItem value="go-sdk" label="Go">
		<NonLocalGoSdkExample />
	</TabItem>
	<TabItem value="javascript-sdk" label="Javascript">
		<NonLocalJavascriptSdkExample />
	</TabItem>
	<TabItem value="python-sdk" label="Python">
		<NonLocalPythonSdkExample />
	</TabItem>
	<TabItem value="rust-sdk" label="Rust">
		<NonLocalRustSdkExample />
	</TabItem>
	<TabItem value="k8s" label="Kubernetes Controller">
		<NonLocalKubernetesExample />
	</TabItem>
</Tabs>

### HTTP/2 forwarding

When agents forward to upstream http/2 services, connections use HTTP/1.1 by
default.

You can configure the agent, SDKs and Kubernetes Operator to instead use HTTP/2
when forwarding to your upstream service.

| Forwarder           | Option                            | Docs                                      |
| ------------------- | --------------------------------- | ----------------------------------------- |
| Agent               | `--upstream-protocol`             | [Agent CLI flags](/agent/cli/#ngrok-http) |
| Agent SDKs          | language-dependent                | [Agent SDKs](/agent-sdks)                 |
| Kubernetes Operator | `appProtocol` on the `Tunnel` CRD | [Kubernetes Operator](/k8s)               |

When http2 forwarding is enabled, all requests to your upstream service will be
transmitted over HTTP/2 Cleartext since TLS was already terminated at the ngrok
cloud service. We cannot use
[TLS-ALPN](https://httpwg.org/specs/rfc7540.html#TLS-ALPN) at this time. We
rely on [HTTP/2 with Prior
Knowledge](https://httpwg.org/specs/rfc7540.html#known-http) currently.

### Serving file directories

The ngrok agent supports the `file://` scheme in a forwarding URL. When you use
the `file://` scheme, the ngrok agent serves local file system directories by
using its own built-in file server, no separate server needed. It works just
like `python3 -m http.server` but it is built directly into the ngrok agent.

Paths in `file://` URLs must be specified as absolute paths.

#### Serve files in `/var/log`

<Tabs groupId="connectivity" queryString="cty">
	<TabItem value="agent-cli" label="Agent CLI" default>
		<AbsPathFileserverAgentCliExample />
	</TabItem>
	<TabItem value="agent-config" label="Agent Config">
		<AbsPathFileserverAgentConfigExample />
	</TabItem>
	<TabItem value="ssh" label="SSH">
		<AbsPathFileserverSshExample />
	</TabItem>
	<TabItem value="go-sdk" label="Go">
		<AbsPathFileserverGoSdkExample />
	</TabItem>
	<TabItem value="javascript-sdk" label="Javascript">
		<AbsPathFileserverJavascriptSdkExample />
	</TabItem>
	<TabItem value="python-sdk" label="Python">
		<AbsPathFileserverPythonSdkExample />
	</TabItem>
	<TabItem value="rust-sdk" label="Rust">
		<AbsPathFileserverRustSdkExample />
	</TabItem>
	<TabItem value="k8s" label="Kubernetes Controller">
		<AbsPathFileserverKubernetesExample />
	</TabItem>
</Tabs>

<br />

#### Serve files on Windows

<Tabs groupId="connectivity" queryString="cty">
	<TabItem value="agent-cli" label="Agent CLI" default>
		<WindowsFileserverAgentCliExample />
	</TabItem>
	<TabItem value="agent-config" label="Agent Config">
		<WindowsFileserverAgentConfigExample />
	</TabItem>
	<TabItem value="ssh" label="SSH">
		<WindowsFileserverSshExample />
	</TabItem>
	<TabItem value="go-sdk" label="Go">
		<WindowsFileserverGoSdkExample />
	</TabItem>
	<TabItem value="javascript-sdk" label="Javascript">
		<WindowsFileserverJavascriptSdkExample />
	</TabItem>
	<TabItem value="python-sdk" label="Python">
		<WindowsFileserverPythonSdkExample />
	</TabItem>
	<TabItem value="rust-sdk" label="Rust">
		<WindowsFileserverRustSdkExample />
	</TabItem>
	<TabItem value="k8s" label="Kubernetes Controller">
		<WindowsFileserverKubernetesExample />
	</TabItem>
</Tabs>

<br />

#### Serve files in your current working directory

<Tabs groupId="connectivity" queryString="cty">
	<TabItem value="agent-cli" label="Agent CLI" default>
		<WorkingDirFileserverAgentCliExample />
	</TabItem>
	<TabItem value="agent-config" label="Agent Config">
		<WorkingDirFileserverAgentConfigExample />
	</TabItem>
	<TabItem value="ssh" label="SSH">
		<WorkingDirFileserverSshExample />
	</TabItem>
	<TabItem value="go-sdk" label="Go">
		<WorkingDirFileserverGoSdkExample />
	</TabItem>
	<TabItem value="javascript-sdk" label="Javascript">
		<WorkingDirFileserverJavascriptSdkExample />
	</TabItem>
	<TabItem value="python-sdk" label="Python">
		<WorkingDirFileserverPythonSdkExample />
	</TabItem>
	<TabItem value="rust-sdk" label="Rust">
		<WorkingDirFileserverRustSdkExample />
	</TabItem>
	<TabItem value="k8s" label="Kubernetes Controller">
		<WorkingDirFileserverKubernetesExample />
	</TabItem>
</Tabs>

## TCP

### Forward to non-local service

Agents don't just forward to ports on your localhost. You can forward traffic
to any address or URL reachable from the agent. For example, if you want to
forward traffic to a Postgres server running on your network at
`192.168.1.2:5432`:

<Tabs groupId="connectivity" queryString="cty">
	<TabItem value="agent-cli" label="Agent CLI" default>
		<NonLocalAgentCliExample />
	</TabItem>
	<TabItem value="agent-config" label="Agent Config">
		<NonLocalAgentConfigExample />
	</TabItem>
	<TabItem value="ssh" label="SSH">
		<NonLocalSshExample />
	</TabItem>
	<TabItem value="go-sdk" label="Go">
		<NonLocalGoSdkExample />
	</TabItem>
	<TabItem value="javascript-sdk" label="Javascript">
		<NonLocalJavascriptSdkExample />
	</TabItem>
	<TabItem value="python-sdk" label="Python">
		<NonLocalPythonSdkExample />
	</TabItem>
	<TabItem value="rust-sdk" label="Rust">
		<NonLocalRustSdkExample />
	</TabItem>
	<TabItem value="k8s" label="Kubernetes Controller">
		<NonLocalKubernetesExample />
	</TabItem>
</Tabs>

### PROXY Protocol

When you forward traffic to an upstream TCP service, becuase traffic is coming
from the ngrok agent, it won't know the client's original IP address. You can
add the [PROXY
protocol](https://www.haproxy.org/download/1.8/doc/proxy-protocol.txt) header
on connections to your upstream service to send connection information like the
original client IP address to your upstream service. You will need to configure
your upstream service to handle the PROXY protocol header.

<Tabs groupId="connectivity" queryString="cty">
	<TabItem value="agent-cli" label="Agent CLI" default>
		<ProxyProtoAgentCliExample />
	</TabItem>
	<TabItem value="agent-config" label="Agent Config">
		<ProxyProtoAgentConfigExample />
	</TabItem>
	<TabItem value="ssh" label="SSH">
		<ProxyProtoSshExample />
	</TabItem>
	<TabItem value="go-sdk" label="Go">
		<ProxyProtoGoSdkExample />
	</TabItem>
	<TabItem value="javascript-sdk" label="Javascript">
		<ProxyProtoJavascriptSdkExample />
	</TabItem>
	<TabItem value="python-sdk" label="Python">
		<ProxyProtoPythonSdkExample />
	</TabItem>
	<TabItem value="rust-sdk" label="Rust">
		<ProxyProtoRustSdkExample />
	</TabItem>
	<TabItem value="k8s" label="Kubernetes Controller">
		<ProxyProtoKubernetesExample />
	</TabItem>
</Tabs>

## TLS

### Re-encrypt to Upstream

If you terminate TLS at the ngrok cloud service or ngrok agent, you may want to
re-encrypt the connection from the agent to your upstream service. The ngrok
agent supports this behavior by using the non-standard `tls://` scheme syntax.

<Tabs groupId="connectivity" queryString="cty">
<TabItem value="agent-cli" label="Agent CLI" default>

```bash
ngrok tls tls://localhost:443 --terminate-at=edge
```

</TabItem>
<TabItem value="agent-config" label="Agent Config">
<ReencryptUpstreamAgentConfigExample />
</TabItem>
<TabItem value="ssh" label="SSH">
<ReencryptUpstreamSshExample />
</TabItem>
<TabItem value="go-sdk" label="Go">
<ReencryptUpstreamGoSdkExample />
</TabItem>
<TabItem value="javascript-sdk" label="Javascript">
<ReencryptUpstreamJavascriptSdkExample />
</TabItem>
<TabItem value="python-sdk" label="Python">
<ReencryptUpstreamPythonSdkExample />
</TabItem>
<TabItem value="rust-sdk" label="Rust">
<ReencryptUpstreamRustSdkExample />
</TabItem>
<TabItem value="k8s" label="Kubernetes Controller">
<ReencryptUpstreamKubernetesExample />
</TabItem>
</Tabs>

### PROXY Protocol

Add a [PROXY
protocol](https://www.haproxy.org/download/1.8/doc/proxy-protocol.txt) header
on connection to your upstream service. This sends connection information like
the original client IP address to your upstream service.

<Tabs groupId="connectivity" queryString="cty">
	<TabItem value="agent-cli" label="Agent CLI" default>
		<ProxyProtoAgentCliExample />
	</TabItem>
	<TabItem value="agent-config" label="Agent Config">
		<ProxyProtoAgentConfigExample />
	</TabItem>
	<TabItem value="ssh" label="SSH">
		<ProxyProtoSshExample />
	</TabItem>
	<TabItem value="go-sdk" label="Go">
		<ProxyProtoGoSdkExample />
	</TabItem>
	<TabItem value="javascript-sdk" label="Javascript">
		<ProxyProtoJavascriptSdkExample />
	</TabItem>
	<TabItem value="python-sdk" label="Python">
		<ProxyProtoPythonSdkExample />
	</TabItem>
	<TabItem value="rust-sdk" label="Rust">
		<ProxyProtoRustSdkExample />
	</TabItem>
	<TabItem value="k8s" label="Kubernetes Controller">
		<ProxyProtoKubernetesExample />
	</TabItem>
</Tabs>
