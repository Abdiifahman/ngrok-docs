---
title: How Do I Handle HTTP/S traffic?
description: Learn how to create HTTP/S endpoints with ngrok.
---

import TabItem from "@theme/TabItem";
import Tabs from "@theme/Tabs";

import { LangSwitcher } from "@site/src/components/LangSwitcher";
import TlsLimits from "../_tls_limits.mdx";

import RandomAgentCliExample from "/examples/agent-cli/http-random.mdx";
import RandomAgentConfigExample from "/examples/agent-config/http-random.mdx";
import RandomGoSdkExample from "/examples/go-sdk/http-random.mdx";
import RandomJavascriptSdkExample from "/examples/javascript-sdk/http-random.mdx";
import RandomPythonSdkExample from "/examples/python-sdk/http-random.mdx";
import RandomRustSdkExample from "/examples/rust-sdk/http-random.mdx";
import RandomSshExample from "/examples/ssh/http-random.mdx";

import StaticDomainAgentCliExample from "/examples/agent-cli/http-static-domain.mdx";
import StaticDomainAgentConfigExample from "/examples/agent-config/http-static-domain.mdx";
import StaticDomainGoSdkExample from "/examples/go-sdk/http-static-domain.mdx";
import StaticDomainJavascriptSdkExample from "/examples/javascript-sdk/http-static-domain.mdx";
import StaticDomainKubernetesExample from "/examples/k8s/http-static-domain.mdx";
import StaticDomainPythonSdkExample from "/examples/python-sdk/http-static-domain.mdx";
import StaticDomainRustSdkExample from "/examples/rust-sdk/http-static-domain.mdx";
import StaticDomainSshExample from "/examples/ssh/http-static-domain.mdx";

import BrandedDomainAgentCliExample from "/examples/agent-cli/http-branded-domain.mdx";
import BrandedDomainAgentConfigExample from "/examples/agent-config/http-branded-domain.mdx";
import BrandedDomainGoSdkExample from "/examples/go-sdk/http-branded-domain.mdx";
import BrandedDomainJavascriptSdkExample from "/examples/javascript-sdk/http-branded-domain.mdx";
import BrandedDomainKubernetesExample from "/examples/k8s/http-branded-domain.mdx";
import BrandedDomainPythonSdkExample from "/examples/python-sdk/http-branded-domain.mdx";
import BrandedDomainRustSdkExample from "/examples/rust-sdk/http-branded-domain.mdx";
import BrandedDomainSshExample from "/examples/ssh/http-branded-domain.mdx";

import BasicAuthAgentCliExample from "/examples/agent-cli/http-basic-auth.mdx";
import BasicAuthAgentConfigExample from "/examples/agent-config/http-basic-auth.mdx";
import BasicAuthGoSdkExample from "/examples/go-sdk/http-basic-auth.mdx";
import BasicAuthJavascriptSdkExample from "/examples/javascript-sdk/http-basic-auth.mdx";
import BasicAuthKubernetesExample from "/examples/k8s/http-basic-auth.mdx";
import BasicAuthPythonSdkExample from "/examples/python-sdk/http-basic-auth.mdx";
import BasicAuthRustSdkExample from "/examples/rust-sdk/http-basic-auth.mdx";
import BasicAuthSshExample from "/examples/ssh/http-basic-auth.mdx";

import OAuthAgentCliExample from "/examples/agent-cli/http-oauth-authn.mdx";
import OAuthAgentConfigExample from "/examples/agent-config/http-oauth-authn.mdx";
import OAuthGoSdkExample from "/examples/go-sdk/http-oauth-authn.mdx";
import OAuthJavascriptSdkExample from "/examples/javascript-sdk/http-oauth-authn.mdx";
import OAuthKubernetesExample from "/examples/k8s/http-oauth-authn.mdx";
import OAuthPythonSdkExample from "/examples/python-sdk/http-oauth-authn.mdx";
import OAuthRustSdkExample from "/examples/rust-sdk/http-oauth-authn.mdx";
import OAuthSshExample from "/examples/ssh/http-oauth-authn.mdx";

import ForwardHttpsAgentCliExample from "/examples/agent-cli/http-forward-https.mdx";
import ForwardHttpsAgentConfigExample from "/examples/agent-config/http-forward-https.mdx";
import ForwardHttpsGoSdkExample from "/examples/go-sdk/http-forward-https.mdx";
import ForwardHttpsJavascriptSdkExample from "/examples/javascript-sdk/http-forward-https.mdx";
import ForwardHttpsKubernetesExample from "/examples/k8s/http-forward-https.mdx";
import ForwardHttpsPythonSdkExample from "/examples/python-sdk/http-forward-https.mdx";
import ForwardHttpsRustSdkExample from "/examples/rust-sdk/http-forward-https.mdx";
import ForwardHttpsSshExample from "/examples/ssh/http-forward-https.mdx";

import HostHeaderAgentCliExample from "/examples/agent-cli/http-rewrite-host-header.mdx";
import HostHeaderAgentConfigExample from "/examples/agent-config/http-rewrite-host-header.mdx";
import HostHeaderGoSdkExample from "/examples/go-sdk/http-rewrite-host-header.mdx";
import HostHeaderJavascriptSdkExample from "/examples/javascript-sdk/http-rewrite-host-header.mdx";
import HostHeaderKubernetesExample from "/examples/k8s/http-rewrite-host-header.mdx";
import HostHeaderPythonSdkExample from "/examples/python-sdk/http-rewrite-host-header.mdx";
import HostHeaderRustSdkExample from "/examples/rust-sdk/http-rewrite-host-header.mdx";
import HostHeaderSshExample from "/examples/ssh/http-rewrite-host-header.mdx";

import NonLocalAgentCliExample from "/examples/agent-cli/http-nonlocal.mdx";
import NonLocalAgentConfigExample from "/examples/agent-config/http-nonlocal.mdx";
import NonLocalGoSdkExample from "/examples/go-sdk/http-nonlocal.mdx";
import NonLocalJavascriptSdkExample from "/examples/javascript-sdk/http-nonlocal.mdx";
import NonLocalKubernetesExample from "/examples/k8s/http-nonlocal.mdx";
import NonLocalPythonSdkExample from "/examples/python-sdk/http-nonlocal.mdx";
import NonLocalRustSdkExample from "/examples/rust-sdk/http-nonlocal.mdx";
import NonLocalSshExample from "/examples/ssh/http-nonlocal.mdx";

import AbsPathFileserverAgentCliExample from "/examples/agent-cli/http-fileserver-abs-path.mdx";
import AbsPathFileserverAgentConfigExample from "/examples/agent-config/http-fileserver-abs-path.mdx";
import AbsPathFileserverGoSdkExample from "/examples/go-sdk/http-fileserver-abs-path.mdx";
import AbsPathFileserverJavascriptSdkExample from "/examples/javascript-sdk/http-fileserver-abs-path.mdx";
import AbsPathFileserverKubernetesExample from "/examples/k8s/http-fileserver-abs-path.mdx";
import AbsPathFileserverPythonSdkExample from "/examples/python-sdk/http-fileserver-abs-path.mdx";
import AbsPathFileserverRustSdkExample from "/examples/rust-sdk/http-fileserver-abs-path.mdx";
import AbsPathFileserverSshExample from "/examples/ssh/http-fileserver-abs-path.mdx";

import WorkingDirFileserverAgentCliExample from "/examples/agent-cli/http-fileserver-working-dir.mdx";
import WorkingDirFileserverAgentConfigExample from "/examples/agent-config/http-fileserver-working-dir.mdx";
import WorkingDirFileserverGoSdkExample from "/examples/go-sdk/http-fileserver-working-dir.mdx";
import WorkingDirFileserverJavascriptSdkExample from "/examples/javascript-sdk/http-fileserver-working-dir.mdx";
import WorkingDirFileserverKubernetesExample from "/examples/k8s/http-fileserver-working-dir.mdx";
import WorkingDirFileserverPythonSdkExample from "/examples/python-sdk/http-fileserver-working-dir.mdx";
import WorkingDirFileserverRustSdkExample from "/examples/rust-sdk/http-fileserver-working-dir.mdx";
import WorkingDirFileserverSshExample from "/examples/ssh/http-fileserver-working-dir.mdx";

import WindowsFileserverAgentCliExample from "/examples/agent-cli/http-fileserver-windows.mdx";
import WindowsFileserverAgentConfigExample from "/examples/agent-config/http-fileserver-windows.mdx";
import WindowsFileserverGoSdkExample from "/examples/go-sdk/http-fileserver-windows.mdx";
import WindowsFileserverJavascriptSdkExample from "/examples/javascript-sdk/http-fileserver-windows.mdx";
import WindowsFileserverKubernetesExample from "/examples/k8s/http-fileserver-windows.mdx";
import WindowsFileserverPythonSdkExample from "/examples/python-sdk/http-fileserver-windows.mdx";
import WindowsFileserverRustSdkExample from "/examples/rust-sdk/http-fileserver-windows.mdx";
import WindowsFileserverSshExample from "/examples/ssh/http-fileserver-windows.mdx";

You can create HTTP/S endpoints to serve web services like REST APIs, web applications, websites and websocket servers.

## Quickstart

<Tabs groupId="connectivity" queryString="cty">
	<TabItem value="agent-endpoint" label="Agent Endpoint" default>
	[Agent Endpoints](/agent/) are the easiest way to create an HTTP/S endpoint. You can start agent endpoints on your local machine. The endpoint wil llive for the lifetime of the process and forward traffic to a port or URL of your choosing.

    The following example creates the endpoint `https://example.ngrok.app` and forwards its traffic to a local port.

    <LangSwitcher>
    ```bash
    ngrok http 8080 --url https://example.ngrok.app
    ```
    ```sh tabName="SSH"
    ssh -R example.ngrok.app:443:localhost:8080 v2@connect.ngrok-agent.com http
    ```
    ```go
    import (
    	"context"
    	"net"

    		"golang.ngrok.com/ngrok"
    		"golang.ngrok.com/ngrok/config"

    )

    func ngrokListener(ctx context.Context) (net.Listener, error) {
    upstreamURL, \_ := url.Parse("http://localhost:8080")
    return ngrok.ListenAndForward(ctx,
    upstreamURL,
    config.HTTPEndpoint(
    config.WithURL("https://example.ngrok.app"),
    ),
    ngrok.WithAuthtokenFromEnv(),
    )
    }

    ```
    ```jsx
    const ngrok = require("@ngrok/ngrok");

    (async function () {
    	const listener = await ngrok.forward({
    		addr: 8080,
    		authtoken_from_env: true,
    		domain: "example.ngrok.app",
    	});

    	console.log(`Ingress established at: ${listener.url()}`);
    })();
    ```

    ```python
    import ngrok

    listener = ngrok.forward("localhost:8080", authtoken_from_env=True,
    		domain="example.ngrok.app")

    print(f"Ingress established at: {listener.url()}");
    ```

    ```rust
    use ngrok::prelude::*;

    async fn listen_ngrok() -> anyhow::Result<impl Tunnel> {
    		let sess = ngrok::Session::builder()
    				.authtoken_from_env()
    				.connect()
    				.await?;

    		let tun = sess
    				.http_endpoint()
    				.domain("example.ngrok.app")
    				.listen()
    				.await?;

    		println!("Listening on URL: {:?}", tun.url());

    		Ok(tun)
    }
    ```

    </LangSwitcher>

    </TabItem>
    <TabItem value="cloud-endpoint" label="Cloud Endpoint">

[Cloud endpoints](/universal-gateway/cloud-endpoints/) are created via [the ngrok Dashboard](https://dashboard.ngrok.com/endpoints/new) or [API](/api/). They are persistent and live until they are deleted. [Traffic Policy](/traffic-policy/) controls how a cloud endpoint handles traffic.

To create an HTTPS cloud endpoint which returns a `Hello world!` `200 OK` response, you can add the following to your Cloud Endpoint's Traffic Policy in the ngrok Dashboard:

```yaml
on_http_request:
  - actions:
      - type: custom-response
        config:
          status_code: 200
          headers:
            content-type: text/plain
          content: "Hello world!"
```

If you want to add it with the API instead, you can save that policy to a local file, then run the following command in your terminal, referencing the file you created:

```sh title="Command line"
ngrok api endpoints create \
  --url https://example.ngrok.app \
  --traffic-policy "$(<traffic-policy.yml)"
```

    	</TabItem>
    <TabItem value="k8s" label="Kubernetes Controller">

    	Follow the [ngrok Kubernetes Controller documentation](https://ngrok.com/docs/k8s/guides/quickstart/) to get started using ngrok with Kubernetes. You can use the following service definition to create an HTTP endpoint:

    <StaticDomainKubernetesExample />


    </TabItem>
    <TabItem value="agent-config" label="Agent Config File">

    You can create an HTTP/S endpoint using the [ngrok agent configuration file](/docs/traffic-policy/getting-started/agent-endpoints/config-file). You can edit the file with the following terminal command:

    ```bash
    ngrok config edit
    ```

    Specify the endpoint URL in your configuration as shown in the following example:

    <StaticDomainAgentConfigExample />

    Then, start the agent with the following command:

    ```bash
    ngrok http 8080
    ```
    	</TabItem>

</Tabs>

## Learn more

- **URLS** — URLs are validated differently depending on their [binding](/universal-gateway/bindings). To learn more about valid URLs for HTTP/S endpoints, see [the Endpoint URLs documentation](/docs/universal-gateway/what-are-endpoint-urls/#http).
- **Domains** — Public HTTP/S endpoints must match a domain on your account. See [the domains documentation](/universal-gateway/domains/what-are-domains/) for more information.
- **Bring your own domain** — To use your own domain with HTTP/S endpoints, see [the guide on the subject](/universal-gateway/how-do-i-use-my-own-domain).
- **Wildcard Endpoints** — You can create HTTP/S endpoints that receive traffic from all of the subdomains matching a given wildcard domain. See [the wildcard domain docs](/universal-gateway/wildcard-domains/) for more information.
- **Traffic Policy** — Attach [Traffic Policy](/traffic-policy/) to endpoints to route, authenticate and transform the traffic through the endpoint.
- **Agent Forwarding** — The [ngrok agent](/agent/) and [Agent SDKs](/agent-sdks/) forward traffic that your endpoints receive to upstream services. See [the agent forwarding documentation](/universal-gateway/agent-forwarding/) for more information.
- **URLS** —
- **URLS** —
- **URLS** —

## Traffic Observability

### Traffic Inspector

[Traffic Inspector](/obs/traffic-inspection/) gives you a real-time view in the
ngrok dashboard of the HTTP traffic flowing through your HTTP/S endpoints. You
can choose whether Traffic Inspector captures only request metadata or full
request and response bodies.

### Log Export Events

You can export logs of traffic to HTTP/S endpoints with [ngrok's events
system](/obs/). The following events are published for log exporting:

| Event                                                                    | When                                                              |
| ------------------------------------------------------------------------ | ----------------------------------------------------------------- |
| [http_request_complete.v0](/obs/events/reference/#http-request-complete) | Published when an HTTP request to an HTTP/S endpoints completes.  |
| [tcp_connection_closed.v0](/obs/events/reference/#tcp-connection-closed) | Published when a TCP connection to an HTTP/S endpoints completes. |

## Advanced

HTTP/S endpoints are standards-compliant HTTP reverse proxies.

### Versions

- HTTP/S endpoints support HTTP/1.1.
- HTTPS endpoints support HTTP/1.1 and HTTP/2.
- HTTP/1.0, HTTP/3 and QUIC are **not** supported.

### HTTP/2

HTTPS endpoints will automatically use HTTP/2 for all connections if the client
supports it. Client support is determined via standard ALPN negotiation.

HTTP/2 is used between the client and your endpoint even even if your upstream
service does not support HTTP/2.

The section on [HTTP/2 agent forwarding](#http2-forwarding) has details on how to
configure the use of HTTP/2 when sending traffic to an upstream service.

### Websockets

Websocket connections are supported out-of-the-box. No configuration is required.

### Hop by hop headers

ngrok does not forward any [hop-by-hop
headers](https://datatracker.ietf.org/doc/html/rfc2616#section-13.5.1) to the
upstream service. As an exception, `Connection: upgrade` headers are forwarded
to support [websockets](#websockets).

For information on headers added automatically by ngrok, see
[Upstream Headers](#upstream-headers).

### Persistent connections

When a connection is made to HTTP/S ngrok endpoints with HTTP/1.1, ngrok may
choose to use persistent connections (aka HTTP keep-alive) to improve the
performance of future requests from the same client if the client supports it.

This behavior is not guaranteed and it is not configurable.

See [RFC 7230](https://datatracker.ietf.org/doc/html/rfc7230#section-6.3) for
additional details.

### Well Known URIs

#### `/.well-known/acme-challenge`

ngrok takes over handling of this path of any HTTP endpoint matching a
[Domain](/universal-gateway/domains/what-are-domains) with automated certificate management
enabled. You may disable this behavior by uploading your own certificate on the
matching Domain.

## TLS

ngrok automatically handles TLS (SSL) certificate management and termination for you.
There is nothing to setup, configure or manage.

TLS connections to `https` endpoints are terminated at ngrok's cloud service.
If you wish to terminate TLS traffic at the ngrok agent or in your upstream
application, use a [TLS Endpoint](/universal-gateway/tls) instead.

Consult the following documentation for additional details on how ngrok handles
TLS termination and certificiate management:

- [TLS Certificates](/universal-gateway/tls-certificates/how-does-ngrok-handle-tls)
- [TLS Termination](/universal-gateway/tls-termination)

## Upstream Headers

ngrok adds headers to each HTTP request with information about the original
client IP, request scheme and request `host` header value.

| Header              | Description                                                                                                                                 |
| ------------------- | ------------------------------------------------------------------------------------------------------------------------------------------- |
| `x-forwarded-for`   | The IP address of the client who initiated the request. If this header exists on the original request, ngrok will append a new value.       |
| `x-forwarded-proto` | The scheme of the original request, either `http` or `https`. If this header exists on the original request, ngrok will append a new value. |
| `x-forwarded-host`  | The header from the client's request if it existed, otherwise is set to the request's `Host` header value.                                  |

Because ngrok appends values to `x-forwarded-for` and `x-forwarded-proto`, be
sure to use the last value of the header in your application code to read the
values injected by ngrok.

You may remove these headers with the [Remove
Headers](/traffic-policy/actions/remove-headers/) Traffic Policy action.

## Limits & Timeouts

[Contact us](mailto:support@ngrok.com) if you need to configure limits and
timeouts on connections to HTTP endpoints.

#### Connection

| Limit     | Name                | Notes                                                        |
| --------- | ------------------- | ------------------------------------------------------------ |
| 5 minutes | Client Idle Timeout | Time since data was last transmitted by the upstream service |
| 5 minutes | Server Idle Timeout | Time since data was last transmitted by the upstream service |
| No limit  | Data transmitted    | Data transmitted by the client or upstream service           |

#### TLS

<TlsLimits />

#### HTTP

| Limit      | Name               | Notes                                         |
| ---------- | ------------------ | --------------------------------------------- |
| No timeout | Round Trip Timeout | Time for the entire HTTP request and response |

#### HTTP Request

| Limit      | Name                   | Notes                                                |
| ---------- | ---------------------- | ---------------------------------------------------- |
| 1 MB       | Request Header Size    | Includes method, URI and headers                     |
| 1 MB       | Request URI Length     | Limited by the size of the request header            |
| No timeout | Request Timeout        | Time to read the entire HTTP request from the client |
| No timeout | Request Header Timeout | Time to read the HTTP request header from the client |
| No limit   | Request Body Size      |                                                      |

#### HTTP Response

| Limit      | Name                    | Notes                                                 |
| ---------- | ----------------------- | ----------------------------------------------------- |
| 1 MB       | Response Header Size    | Includes method, URI and headers                      |
| No timeout | Response Timeout        | Time to read the entire HTTP response from the server |
| No timeout | Response Header Timeout | Time to read the HTTP response header from the server |
| No limit   | Response Body Size      |                                                       |

## Errors

If ngrok fails to handle an HTTP request it will set the `ngrok-error-code`
header in the HTTP response with a [unique ngrok Error Code](/errors/)
describing the failure.

ngrok guarantees that the upstream service may never set the `ngrok-error-code`
HTTP response header so you know reliably that it was set by ngrok.

ngrok may return an error under the following conditions:

- Your upstream service timed out or rejected the connection
- Your upstream service returned a response that was not valid HTTP
- A [Traffic Policy](/traffic-policy) action rejected the request.
- [Traffic Policy](/traffic-policy) execution encountered a runtime error.
- ngrok encountered an internal error

## API

HTTP/S Endpoints can be created programatically. Consult the documentation on
[Endpoint APIs](/api/resources/endpoints/).

## Pricing

HTTP/S endpoints are available on all plans. Consult the [Endpoints
Pricing](/universal-gateway/endpoints/#pricing) documentation for
billing details.

See [Domains pricing](/universal-gateway/domains/#pricing) for details on
pricing for custom domains, wildcard domains and more.
